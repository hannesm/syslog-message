<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Syslog_message" rel="Chapter" href="Syslog_message.html"><title>Syslog_message</title>
</head>
<body>
<div class="navbar">&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;</div>
<h1>Module <a href="type_Syslog_message.html">Syslog_message</a></h1>

<pre><span class="keyword">module</span> Syslog_message: <code class="code">sig</code> <a href="Syslog_message.html">..</a> <code class="code">end</code></pre><div class="info module top">
Module for parsing RFC 3164 Syslog messages<br>
</div>
<hr width="100%">

<pre><code><span id="TYPEfacility"><span class="keyword">type</span> <code class="type"></code>facility</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Kernel_Message"><span class="constructor">Kernel_Message</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.User_Level_Messages"><span class="constructor">User_Level_Messages</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Mail_System"><span class="constructor">Mail_System</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.System_Daemons"><span class="constructor">System_Daemons</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Security_Authorization_Messages"><span class="constructor">Security_Authorization_Messages</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Messages_Generated_Internally_By_Syslogd"><span class="constructor">Messages_Generated_Internally_By_Syslogd</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Line_Printer_Subsystem"><span class="constructor">Line_Printer_Subsystem</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Network_News_Subsystem"><span class="constructor">Network_News_Subsystem</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.UUCP_subsystem"><span class="constructor">UUCP_subsystem</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Clock_Daemon"><span class="constructor">Clock_Daemon</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Security_Authorization_Messages_10"><span class="constructor">Security_Authorization_Messages_10</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Ftp_Daemon"><span class="constructor">Ftp_Daemon</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Ntp_Subsystem"><span class="constructor">Ntp_Subsystem</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Log_Audit"><span class="constructor">Log_Audit</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Log_Alert"><span class="constructor">Log_Alert</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Clock_Daemon_15"><span class="constructor">Clock_Daemon_15</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Local0"><span class="constructor">Local0</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Local1"><span class="constructor">Local1</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Local2"><span class="constructor">Local2</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Local3"><span class="constructor">Local3</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Local4"><span class="constructor">Local4</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Local5"><span class="constructor">Local5</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Local6"><span class="constructor">Local6</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Local7"><span class="constructor">Local7</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTfacility.Invalid_Facility"><span class="constructor">Invalid_Facility</span></span></code></td>

</tr></table>

<div class="info ">
The type for Facilities<br>
</div>


<pre><span id="VALint_of_facility"><span class="keyword">val</span> int_of_facility</span> : <code class="type"><a href="Syslog_message.html#TYPEfacility">facility</a> -> int</code></pre><div class="info ">
Convert a <a href="Syslog_message.html#TYPEfacility"><code class="code">Syslog_message.facility</code></a> into an integer<br>
</div>

<pre><span id="VALfacility_of_int"><span class="keyword">val</span> facility_of_int</span> : <code class="type">int -> <a href="Syslog_message.html#TYPEfacility">facility</a></code></pre><div class="info ">
Converts an integer into a <a href="Syslog_message.html#TYPEfacility"><code class="code">Syslog_message.facility</code></a><br>
</div>

<pre><span id="VALstring_of_facility"><span class="keyword">val</span> string_of_facility</span> : <code class="type"><a href="Syslog_message.html#TYPEfacility">facility</a> -> string</code></pre><div class="info ">
Converts a <a href="Syslog_message.html#TYPEfacility"><code class="code">Syslog_message.facility</code></a> into a string<br>
</div>

<pre><code><span id="TYPEseverity"><span class="keyword">type</span> <code class="type"></code>severity</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTseverity.Emergency"><span class="constructor">Emergency</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTseverity.Alert"><span class="constructor">Alert</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTseverity.Critical"><span class="constructor">Critical</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTseverity.Error"><span class="constructor">Error</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTseverity.Warning"><span class="constructor">Warning</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTseverity.Notice"><span class="constructor">Notice</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTseverity.Informational"><span class="constructor">Informational</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTseverity.Debug"><span class="constructor">Debug</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTseverity.Invalid_Severity"><span class="constructor">Invalid_Severity</span></span></code></td>

</tr></table>

<div class="info ">
The type for Severity levels<br>
</div>


<pre><span id="VALint_of_severity"><span class="keyword">val</span> int_of_severity</span> : <code class="type"><a href="Syslog_message.html#TYPEseverity">severity</a> -> int</code></pre><div class="info ">
Converts a <a href="Syslog_message.html#TYPEseverity"><code class="code">Syslog_message.severity</code></a> into an integer<br>
</div>

<pre><span id="VALseverity_of_int"><span class="keyword">val</span> severity_of_int</span> : <code class="type">int -> <a href="Syslog_message.html#TYPEseverity">severity</a></code></pre><div class="info ">
Converts an integer into a <a href="Syslog_message.html#TYPEseverity"><code class="code">Syslog_message.severity</code></a><br>
</div>

<pre><span id="VALstring_of_severity"><span class="keyword">val</span> string_of_severity</span> : <code class="type"><a href="Syslog_message.html#TYPEseverity">severity</a> -> string</code></pre><div class="info ">
Converts a <a href="Syslog_message.html#TYPEseverity"><code class="code">Syslog_message.severity</code></a> into a string<br>
</div>

<pre><code><span id="TYPEtimestamp"><span class="keyword">type</span> <code class="type"></code>timestamp</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtimestamp.month">month</span>&nbsp;: <code class="type">int</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtimestamp.day">day</span>&nbsp;: <code class="type">int</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtimestamp.hour">hour</span>&nbsp;: <code class="type">int</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtimestamp.minute">minute</span>&nbsp;: <code class="type">int</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtimestamp.second">second</span>&nbsp;: <code class="type">int</code>;</code></td>

</tr></table>
}

<div class="info ">
The type for RFC 3164 compatible timestamps<br>
</div>


<pre><span id="VALstring_of_timestamp"><span class="keyword">val</span> string_of_timestamp</span> : <code class="type"><a href="Syslog_message.html#TYPEtimestamp">timestamp</a> -> string</code></pre><div class="info ">
<code class="code">string_of_timestamp</code> Converts a <a href="Syslog_message.html#TYPEtimestamp"><code class="code">Syslog_message.timestamp</code></a> into a string<br>
</div>

<pre><code><span id="TYPEt"><span class="keyword">type</span> <code class="type"></code>t</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTt.facility">facility</span>&nbsp;: <code class="type"><a href="Syslog_message.html#TYPEfacility">facility</a></code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTt.severity">severity</span>&nbsp;: <code class="type"><a href="Syslog_message.html#TYPEseverity">severity</a></code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTt.timestamp">timestamp</span>&nbsp;: <code class="type"><a href="Syslog_message.html#TYPEtimestamp">timestamp</a></code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTt.hostname">hostname</span>&nbsp;: <code class="type">string</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTt.message">message</span>&nbsp;: <code class="type">string</code>;</code></td>

</tr></table>
}

<div class="info ">
The type for Syslog messages<br>
</div>


<pre><span id="VALpp_string"><span class="keyword">val</span> pp_string</span> : <code class="type"><a href="Syslog_message.html#TYPEt">t</a> -> string</code></pre><div class="info ">
<code class="code">pp_string</code> returns a pretty-printed string of <a href="Syslog_message.html#TYPEt"><code class="code">Syslog_message.t</code></a><br>
</div>

<pre><span id="VALpp"><span class="keyword">val</span> pp</span> : <code class="type"><a href="Syslog_message.html#TYPEt">t</a> -> unit</code></pre><div class="info ">
<code class="code">pp</code> pretty-prints a <a href="Syslog_message.html#TYPEt"><code class="code">Syslog_message.t</code></a> using print_string<br>
</div>

<pre><code><span id="TYPEctx"><span class="keyword">type</span> <code class="type"></code>ctx</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTctx.timestamp">timestamp</span>&nbsp;: <code class="type"><a href="Syslog_message.html#TYPEtimestamp">timestamp</a></code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTctx.hostname">hostname</span>&nbsp;: <code class="type">string</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTctx.set_hostname">set_hostname</span>&nbsp;: <code class="type">bool</code>;</code></td>

</tr></table>
}

<div class="info ">
<code class="code">ctx</code> provides additional information to the <a href="Syslog_message.html#VALparse"><code class="code">Syslog_message.parse</code></a> function in case one of the
sub-parsers fails.<ul>
<li><code class="code">timestamp</code>: A <a href="Syslog_message.html#TYPEtimestamp"><code class="code">Syslog_message.timestamp</code></a></li>
<li><code class="code">hostname</code>: Hostname, IPv4 or IPv6 address of the sender. "<i>-</i>" if unknown.</li>
<li><code class="code">set_hostname</code>: If true, the <a href="Syslog_message.html#VALparse"><code class="code">Syslog_message.parse</code></a> function will skip its hostname
sub-parser and use the hostname from <a href="Syslog_message.html#TYPEctx"><code class="code">Syslog_message.ctx</code></a> instead.</li>
</ul>

<code class="code">set_hostname</code> is automatically set by the timestamp sub-parser when it fails, because at this
point it is no longer possible to determine the hostname from the input string.<br>
</div>


<pre><span id="VALctx_hostname"><span class="keyword">val</span> ctx_hostname</span> : <code class="type"><a href="Syslog_message.html#TYPEctx">ctx</a> -> string -> <a href="Syslog_message.html#TYPEctx">ctx</a></code></pre><div class="info ">
<code class="code">ctx_hostname</code> sets a new hostname in <a href="Syslog_message.html#TYPEctx"><code class="code">Syslog_message.ctx</code></a><br>
</div>

<pre><span id="VALctx_set_hostname"><span class="keyword">val</span> ctx_set_hostname</span> : <code class="type"><a href="Syslog_message.html#TYPEctx">ctx</a> -> <a href="Syslog_message.html#TYPEctx">ctx</a></code></pre><div class="info ">
<code class="code">ctx_set_hostname</code><br>
</div>

<pre><span id="VALparse"><span class="keyword">val</span> parse</span> : <code class="type">?ctx:<a href="Syslog_message.html#TYPEctx">ctx</a> -> string -> <a href="Syslog_message.html#TYPEt">t</a> option</code></pre><div class="info ">
<code class="code">parse</code>s a string containing a Syslog message and returns an option <a href="Syslog_message.html#TYPEt"><code class="code">Syslog_message.t</code></a><br>
</div>
</body></html>